/* eslint no-unused-vars : 0 */
import MersenneTwister from 'mersenne-twister';
import SimplexNoise from 'simplex-noise';

import config from './config/config.json';
import elevationMapConfig from './config/elevationMap.json';

import PixiMapRenderer from './renderer/PixiMapRenderer';

import { oahuTheme, grayscaleTheme } from './themes';

import { organicNoiseGenerator, scaledNoiseGenerator, combineMaps } from './noises/noiseGen';

console.info('FINISTERRA - 2D World generated by noise functions and renderered with Pixi.js');
const app = new PixiMapRenderer(config.canvas, config.renderer, config.map);

// // Define Land Shape
console.info('GENERATE LAND MASS SHAPE');

const generateLandMass = (dimensions, noiseConfig) => {
  const rngGenerator = new MersenneTwister();
  const simplexNoise = new SimplexNoise(rngGenerator.random());

  // noise with smooth transitions
  const scaledNoise = scaledNoiseGenerator(simplexNoise, noiseConfig.scaledNoise, dimensions);

  // organic noise
  const organicNoise = organicNoiseGenerator(simplexNoise, noiseConfig.organicNoise, dimensions);

  // combine both noises, give
  const heightMap = combineMaps(
    config.map,
    organicNoise,
    scaledNoise,
    noiseConfig.combineMaps.weight,
  );
  return heightMap;
};

const elevationNoise = generateLandMass(config.map, elevationMapConfig);

console.info('***** Render Maps *****');
app.renderNoiseMap(elevationNoise, oahuTheme, 'height map');
